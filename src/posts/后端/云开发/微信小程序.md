---
icon: article
date: 2022-01-10
title: 微信小程序
category:
- 后端
- 云开发

tag:
- 微信小程序
---

## 学习

[开发文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/capabilities.html#%E6%95%B0%E6%8D%AE%E5%BA%93)

[B站教程](https://www.bilibili.com/video/BV12z4y1R77r?p=12&spm_id_from=pageDriver)



## 使用

### 传统技艺---增删改查

```js
// 获取数据
  getData: function () {
    console.log(111)
    // 一般写法
    db.collection("user").get({
      success: res => {
        console.log(res)
        this.setData({
          dataObj: res.data
        })
      }
    })

    // es6写法
    db.collection("user").get().then(res => {
      console.log(res)
    })

    // 条件查询
    db.collection("user").where({
        userName: "小米"
      }).get()
      .then(res => {
        console.log(res)
      })
  },

  // 新增shuju
  addData: function (data) {
    // 防止多次点击按钮
    wx.showLoading({
      title: "加载中",
      mask: true
    })
    db.collection("user").add({
      data: data
    }).then(res => {
      console.log(res)
      wx.hideLoading()
    })
  },

  // 修改数据
  updateData: function (data) {
    console.log(data)
    // 防止多次点击按钮
    wx.showLoading({
      title: "加载中",
      mask: true
    })

    // 可更新和添加字段 用set为重置内容
    db.collection("user").where({
      _id: data._id
    }).update({
      data: {
        userAge: data.userAge,
        userName: data.userName
      }
    }).then(res => {
      console.log(res)
      wx.hideLoading()
    })
  },

  // 删除数据
  deleteData: function (data) {
    db.collection("user").doc(data._id)
      .remove()
      .then(res => {
        console.log(res)
      })
  },
```



### 获取条数

```js
// 获取条数
db.collection("user").count().then(res=>{
  console.log(res)
  this.setData({
    count:res.total
  })
})
```



### 监听数据库更改

```js
db.collection("user").watch({
  onChange:res=>{
    console.log(res)
    this.setData({
      dataObj:res.docs,
      count:res.docs.length
    })
  },
  onError:err=>{
    console.log(err)
  }
})
```





### command

[文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/reference-sdk-api/database/command/Command.eq.html)

![image-20220329141510336](/typora-user-images/image-20220329141510336.png)

## 功能





## 注意

#### 由于数据库的权限为所有人可读，仅开发者可读写，所以凡是由数据库控制台中添加的数据都不能修改删除。使用函数添加的数据则可动手。

#### gt--greater than; lt--less than